(function(w,N){typeof exports=="object"&&typeof module<"u"?N(exports,require("nitropack"),require("express"),require("fastify"),require("elysia")):typeof define=="function"&&define.amd?define(["exports","nitropack","express","fastify","elysia"],N):(w=typeof globalThis<"u"?globalThis:w||self,N(w.scalex={}))})(this,function(w){"use strict";var N=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Oe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ie={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(N,function(){var r=1e3,n=6e4,i=36e5,d="millisecond",g="second",h="minute",D="hour",A="day",V="week",_="month",ve="quarter",T="year",Y="date",Me="Invalid Date",it=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,ut=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,ct={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(c){var a=["th","st","nd","rd"],s=c%100;return"["+c+(a[(s-20)%10]||a[s]||a[0])+"]"}},oe=function(c,a,s){var u=String(c);return!u||u.length>=a?c:""+Array(a+1-u.length).join(s)+c},lt={s:oe,z:function(c){var a=-c.utcOffset(),s=Math.abs(a),u=Math.floor(s/60),o=s%60;return(a<=0?"+":"-")+oe(u,2,"0")+":"+oe(o,2,"0")},m:function c(a,s){if(a.date()<s.date())return-c(s,a);var u=12*(s.year()-a.year())+(s.month()-a.month()),o=a.clone().add(u,_),l=s-o<0,f=a.clone().add(u+(l?-1:1),_);return+(-(u+(s-o)/(l?o-f:f-o))||0)},a:function(c){return c<0?Math.ceil(c)||0:Math.floor(c)},p:function(c){return{M:_,y:T,w:V,d:A,D:Y,h:D,m:h,s:g,ms:d,Q:ve}[c]||String(c||"").toLowerCase().replace(/s$/,"")},u:function(c){return c===void 0}},W="en",x={};x[W]=ct;var Se="$isDayjsObject",ae=function(c){return c instanceof Z||!(!c||!c[Se])},X=function c(a,s,u){var o;if(!a)return W;if(typeof a=="string"){var l=a.toLowerCase();x[l]&&(o=l),s&&(x[l]=s,o=l);var f=a.split("-");if(!o&&f.length>1)return c(f[0])}else{var y=a.name;x[y]=a,o=y}return!u&&o&&(W=o),o||!u&&W},$=function(c,a){if(ae(c))return c.clone();var s=typeof a=="object"?a:{};return s.date=c,s.args=arguments,new Z(s)},b=lt;b.l=X,b.i=ae,b.w=function(c,a){return $(c,{locale:a.$L,utc:a.$u,x:a.$x,$offset:a.$offset})};var Z=function(){function c(s){this.$L=X(s.locale,null,!0),this.parse(s),this.$x=this.$x||s.x||{},this[Se]=!0}var a=c.prototype;return a.parse=function(s){this.$d=function(u){var o=u.date,l=u.utc;if(o===null)return new Date(NaN);if(b.u(o))return new Date;if(o instanceof Date)return new Date(o);if(typeof o=="string"&&!/Z$/i.test(o)){var f=o.match(it);if(f){var y=f[2]-1||0,p=(f[7]||"0").substring(0,3);return l?new Date(Date.UTC(f[1],y,f[3]||1,f[4]||0,f[5]||0,f[6]||0,p)):new Date(f[1],y,f[3]||1,f[4]||0,f[5]||0,f[6]||0,p)}}return new Date(o)}(s),this.init()},a.init=function(){var s=this.$d;this.$y=s.getFullYear(),this.$M=s.getMonth(),this.$D=s.getDate(),this.$W=s.getDay(),this.$H=s.getHours(),this.$m=s.getMinutes(),this.$s=s.getSeconds(),this.$ms=s.getMilliseconds()},a.$utils=function(){return b},a.isValid=function(){return this.$d.toString()!==Me},a.isSame=function(s,u){var o=$(s);return this.startOf(u)<=o&&o<=this.endOf(u)},a.isAfter=function(s,u){return $(s)<this.startOf(u)},a.isBefore=function(s,u){return this.endOf(u)<$(s)},a.$g=function(s,u,o){return b.u(s)?this[u]:this.set(o,s)},a.unix=function(){return Math.floor(this.valueOf()/1e3)},a.valueOf=function(){return this.$d.getTime()},a.startOf=function(s,u){var o=this,l=!!b.u(u)||u,f=b.p(s),y=function(P,S){var B=b.w(o.$u?Date.UTC(o.$y,S,P):new Date(o.$y,S,P),o);return l?B:B.endOf(A)},p=function(P,S){return b.w(o.toDate()[P].apply(o.toDate("s"),(l?[0,0,0,0]:[23,59,59,999]).slice(S)),o)},v=this.$W,M=this.$M,O=this.$D,H="set"+(this.$u?"UTC":"");switch(f){case T:return l?y(1,0):y(31,11);case _:return l?y(1,M):y(0,M+1);case V:var k=this.$locale().weekStart||0,q=(v<k?v+7:v)-k;return y(l?O-q:O+(6-q),M);case A:case Y:return p(H+"Hours",0);case D:return p(H+"Minutes",1);case h:return p(H+"Seconds",2);case g:return p(H+"Milliseconds",3);default:return this.clone()}},a.endOf=function(s){return this.startOf(s,!1)},a.$set=function(s,u){var o,l=b.p(s),f="set"+(this.$u?"UTC":""),y=(o={},o[A]=f+"Date",o[Y]=f+"Date",o[_]=f+"Month",o[T]=f+"FullYear",o[D]=f+"Hours",o[h]=f+"Minutes",o[g]=f+"Seconds",o[d]=f+"Milliseconds",o)[l],p=l===A?this.$D+(u-this.$W):u;if(l===_||l===T){var v=this.clone().set(Y,1);v.$d[y](p),v.init(),this.$d=v.set(Y,Math.min(this.$D,v.daysInMonth())).$d}else y&&this.$d[y](p);return this.init(),this},a.set=function(s,u){return this.clone().$set(s,u)},a.get=function(s){return this[b.p(s)]()},a.add=function(s,u){var o,l=this;s=Number(s);var f=b.p(u),y=function(M){var O=$(l);return b.w(O.date(O.date()+Math.round(M*s)),l)};if(f===_)return this.set(_,this.$M+s);if(f===T)return this.set(T,this.$y+s);if(f===A)return y(1);if(f===V)return y(7);var p=(o={},o[h]=n,o[D]=i,o[g]=r,o)[f]||1,v=this.$d.getTime()+s*p;return b.w(v,this)},a.subtract=function(s,u){return this.add(-1*s,u)},a.format=function(s){var u=this,o=this.$locale();if(!this.isValid())return o.invalidDate||Me;var l=s||"YYYY-MM-DDTHH:mm:ssZ",f=b.z(this),y=this.$H,p=this.$m,v=this.$M,M=o.weekdays,O=o.months,H=o.meridiem,k=function(S,B,z,K){return S&&(S[B]||S(u,l))||z[B].slice(0,K)},q=function(S){return b.s(y%12||12,S,"0")},P=H||function(S,B,z){var K=S<12?"AM":"PM";return z?K.toLowerCase():K};return l.replace(ut,function(S,B){return B||function(z){switch(z){case"YY":return String(u.$y).slice(-2);case"YYYY":return b.s(u.$y,4,"0");case"M":return v+1;case"MM":return b.s(v+1,2,"0");case"MMM":return k(o.monthsShort,v,O,3);case"MMMM":return k(O,v);case"D":return u.$D;case"DD":return b.s(u.$D,2,"0");case"d":return String(u.$W);case"dd":return k(o.weekdaysMin,u.$W,M,2);case"ddd":return k(o.weekdaysShort,u.$W,M,3);case"dddd":return M[u.$W];case"H":return String(y);case"HH":return b.s(y,2,"0");case"h":return q(1);case"hh":return q(2);case"a":return P(y,p,!0);case"A":return P(y,p,!1);case"m":return String(p);case"mm":return b.s(p,2,"0");case"s":return String(u.$s);case"ss":return b.s(u.$s,2,"0");case"SSS":return b.s(u.$ms,3,"0");case"Z":return f}return null}(S)||f.replace(":","")})},a.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},a.diff=function(s,u,o){var l,f=this,y=b.p(u),p=$(s),v=(p.utcOffset()-this.utcOffset())*n,M=this-p,O=function(){return b.m(f,p)};switch(y){case T:l=O()/12;break;case _:l=O();break;case ve:l=O()/3;break;case V:l=(M-v)/6048e5;break;case A:l=(M-v)/864e5;break;case D:l=M/i;break;case h:l=M/n;break;case g:l=M/r;break;default:l=M}return o?l:b.a(l)},a.daysInMonth=function(){return this.endOf(_).$D},a.$locale=function(){return x[this.$L]},a.locale=function(s,u){if(!s)return this.$L;var o=this.clone(),l=X(s,u,!0);return l&&(o.$L=l),o},a.clone=function(){return b.w(this.$d,this)},a.toDate=function(){return new Date(this.valueOf())},a.toJSON=function(){return this.isValid()?this.toISOString():null},a.toISOString=function(){return this.$d.toISOString()},a.toString=function(){return this.$d.toUTCString()},c}(),we=Z.prototype;return $.prototype=we,[["$ms",d],["$s",g],["$m",h],["$H",D],["$W",A],["$M",_],["$y",T],["$D",Y]].forEach(function(c){we[c[1]]=function(a){return this.$g(a,c[0],c[1])}}),$.extend=function(c,a){return c.$i||(c(a,Z,$),c.$i=!0),$},$.locale=X,$.isDayjs=ae,$.unix=function(c){return $(1e3*c)},$.en=x[W],$.Ls=x,$.p={},$})})(ie);var _e=ie.exports;const Ce=Oe(_e),Q=10,ue=(e=0)=>t=>`\x1B[${t+e}m`,ce=(e=0)=>t=>`\x1B[${38+e};5;${t}m`,le=(e=0)=>(t,r,n)=>`\x1B[${38+e};2;${t};${r};${n}m`,m={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};Object.keys(m.modifier);const De=Object.keys(m.color),Ae=Object.keys(m.bgColor);[...De,...Ae];function Te(){const e=new Map;for(const[t,r]of Object.entries(m)){for(const[n,i]of Object.entries(r))m[n]={open:`\x1B[${i[0]}m`,close:`\x1B[${i[1]}m`},r[n]=m[n],e.set(i[0],i[1]);Object.defineProperty(m,t,{value:r,enumerable:!1})}return Object.defineProperty(m,"codes",{value:e,enumerable:!1}),m.color.close="\x1B[39m",m.bgColor.close="\x1B[49m",m.color.ansi=ue(),m.color.ansi256=ce(),m.color.ansi16m=le(),m.bgColor.ansi=ue(Q),m.bgColor.ansi256=ce(Q),m.bgColor.ansi16m=le(Q),Object.defineProperties(m,{rgbToAnsi256:{value(t,r,n){return t===r&&r===n?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(r/255*5)+Math.round(n/255*5)},enumerable:!1},hexToRgb:{value(t){const r=/[a-f\d]{6}|[a-f\d]{3}/i.exec(t.toString(16));if(!r)return[0,0,0];let[n]=r;n.length===3&&(n=[...n].map(d=>d+d).join(""));const i=Number.parseInt(n,16);return[i>>16&255,i>>8&255,i&255]},enumerable:!1},hexToAnsi256:{value:t=>m.rgbToAnsi256(...m.hexToRgb(t)),enumerable:!1},ansi256ToAnsi:{value(t){if(t<8)return 30+t;if(t<16)return 90+(t-8);let r,n,i;if(t>=232)r=((t-232)*10+8)/255,n=r,i=r;else{t-=16;const h=t%36;r=Math.floor(t/36)/5,n=Math.floor(h/6)/5,i=h%6/5}const d=Math.max(r,n,i)*2;if(d===0)return 30;let g=30+(Math.round(i)<<2|Math.round(n)<<1|Math.round(r));return d===2&&(g+=60),g},enumerable:!1},rgbToAnsi:{value:(t,r,n)=>m.ansi256ToAnsi(m.rgbToAnsi256(t,r,n)),enumerable:!1},hexToAnsi:{value:t=>m.ansi256ToAnsi(m.hexToAnsi256(t)),enumerable:!1}}),m}const C=Te(),U=(()=>{if(navigator.userAgentData){const e=navigator.userAgentData.brands.find(({brand:t})=>t==="Chromium");if(e&&e.version>93)return 3}return/\b(Chrome|Chromium)\//.test(navigator.userAgent)?1:0})(),fe=U!==0&&{level:U,hasBasic:!0,has256:U>=2,has16m:U>=3},Be={stdout:fe,stderr:fe};function je(e,t,r){let n=e.indexOf(t);if(n===-1)return e;const i=t.length;let d=0,g="";do g+=e.slice(d,n)+t+r,d=n+i,n=e.indexOf(t,d);while(n!==-1);return g+=e.slice(d),g}function xe(e,t,r,n){let i=0,d="";do{const g=e[n-1]==="\r";d+=e.slice(i,g?n-1:n)+t+(g?`\r
`:`
`)+r,i=n+1,n=e.indexOf(`
`,i)}while(n!==-1);return d+=e.slice(i),d}const{stdout:de,stderr:he}=Be,ee=Symbol("GENERATOR"),R=Symbol("STYLER"),L=Symbol("IS_EMPTY"),ge=["ansi","ansi","ansi256","ansi16m"],E=Object.create(null),ke=(e,t={})=>{if(t.level&&!(Number.isInteger(t.level)&&t.level>=0&&t.level<=3))throw new Error("The `level` option should be an integer from 0 to 3");const r=de?de.level:0;e.level=t.level===void 0?r:t.level},Pe=e=>{const t=(...r)=>r.join(" ");return ke(t,e),Object.setPrototypeOf(t,F.prototype),t};function F(e){return Pe(e)}Object.setPrototypeOf(F.prototype,Function.prototype);for(const[e,t]of Object.entries(C))E[e]={get(){const r=G(this,re(t.open,t.close,this[R]),this[L]);return Object.defineProperty(this,e,{value:r}),r}};E.visible={get(){const e=G(this,this[R],!0);return Object.defineProperty(this,"visible",{value:e}),e}};const te=(e,t,r,...n)=>e==="rgb"?t==="ansi16m"?C[r].ansi16m(...n):t==="ansi256"?C[r].ansi256(C.rgbToAnsi256(...n)):C[r].ansi(C.rgbToAnsi(...n)):e==="hex"?te("rgb",t,r,...C.hexToRgb(...n)):C[r][e](...n),Re=["rgb","hex","ansi256"];for(const e of Re){E[e]={get(){const{level:r}=this;return function(...n){const i=re(te(e,ge[r],"color",...n),C.color.close,this[R]);return G(this,i,this[L])}}};const t="bg"+e[0].toUpperCase()+e.slice(1);E[t]={get(){const{level:r}=this;return function(...n){const i=re(te(e,ge[r],"bgColor",...n),C.bgColor.close,this[R]);return G(this,i,this[L])}}}}const Ee=Object.defineProperties(()=>{},{...E,level:{enumerable:!0,get(){return this[ee].level},set(e){this[ee].level=e}}}),re=(e,t,r)=>{let n,i;return r===void 0?(n=e,i=t):(n=r.openAll+e,i=t+r.closeAll),{open:e,close:t,openAll:n,closeAll:i,parent:r}},G=(e,t,r)=>{const n=(...i)=>Ie(n,i.length===1?""+i[0]:i.join(" "));return Object.setPrototypeOf(n,Ee),n[ee]=e,n[R]=t,n[L]=r,n},Ie=(e,t)=>{if(e.level<=0||!t)return e[L]?"":t;let r=e[R];if(r===void 0)return t;const{openAll:n,closeAll:i}=r;if(t.includes("\x1B"))for(;r!==void 0;)t=je(t,r.close,r.open),r=r.parent;const d=t.indexOf(`
`);return d!==-1&&(t=xe(t,i,n,d)),n+t+i};Object.defineProperties(F.prototype,E);const Ye=F();F({level:he?he.level:0});const I=Ye;let be={log:console.log};const He=e=>{be=e},J=(e,t)=>{const r=t?.type||"info",n=`🫡 ${I.bgBlue(" ScaleX ")}`,i=`${Ce().format("DD/MM/YYYY, HH:mm")}`,d=I.dim(`[${r.toUpperCase()}]`),g={info:I.blue,success:I.green,error:I.red,warn:I.yellow};be?.log(`${n} ${i} ${d} ${g[r](e)}`)},Ne=(e,t)=>[e,t],Le=e=>e({log:J}),Fe=e=>e,ye=e=>{const t=e.startsWith("/")?e:`/${e}`;return t.endsWith("/")?t.slice(0,-1):t},We=(e,t,r)=>{r({log:J}).forEach(n=>{const i=n.method?n.method.toLowerCase():"get",d=e.methods[i],g=ye(t)+ye(n.path);d(g,h=>(n.statusCode&&h.setStatusCode(n.statusCode),n.handler(h)))})},qe=(e,t)=>{t.forEach(r=>{r.routers.forEach(([n,i])=>{We(e,n,i)})})},ze=(e,{logger:t,...r})=>(t&&He(t),J("Starting an application..."),qe(e,r.modules),J("Application successfully started"),e.server);function me(e,t){try{return t in e}catch{return!1}}var Ue=Object.defineProperty,Ge=(e,t,r)=>t in e?Ue(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,j=(e,t,r)=>(Ge(e,typeof t!="symbol"?t+"":t,r),r);class ne extends Error{constructor(t,r={}){super(t,r),j(this,"statusCode",500),j(this,"fatal",!1),j(this,"unhandled",!1),j(this,"statusMessage"),j(this,"data"),j(this,"cause"),r.cause&&!this.cause&&(this.cause=r.cause)}toJSON(){const t={message:this.message,statusCode:se(this.statusCode,500)};return this.statusMessage&&(t.statusMessage=pe(this.statusMessage)),this.data!==void 0&&(t.data=this.data),t}}j(ne,"__h3_error__",!0);function Je(e){if(typeof e=="string")return new ne(e);if(Ve(e))return e;const t=new ne(e.message??e.statusMessage??"",{cause:e.cause||e});if(me(e,"stack"))try{Object.defineProperty(t,"stack",{get(){return e.stack}})}catch{try{t.stack=e.stack}catch{}}if(e.data&&(t.data=e.data),e.statusCode?t.statusCode=se(e.statusCode,t.statusCode):e.status&&(t.statusCode=se(e.status,t.statusCode)),e.statusMessage?t.statusMessage=e.statusMessage:e.statusText&&(t.statusMessage=e.statusText),t.statusMessage){const r=t.statusMessage;pe(t.statusMessage)!==r&&console.warn("[h3] Please prefer using `message` for longer error messages instead of `statusMessage`. In the future, `statusMessage` will be sanitized by default.")}return e.fatal!==void 0&&(t.fatal=e.fatal),e.unhandled!==void 0&&(t.unhandled=e.unhandled),t}function Ve(e){return e?.constructor?.__h3_error__===!0}const Xe=/[^\u0009\u0020-\u007E]/g;function pe(e=""){return e.replace(Xe,"")}function se(e,t=200){return!e||(typeof e=="string"&&(e=Number.parseInt(e,10)),e<100||e>999)?t:e}typeof setImmediate>"u"||setImmediate;function Ze(e){if(typeof e=="function")return Object.assign(e,{__is_handler__:!0});const t={onRequest:$e(e.onRequest),onBeforeResponse:$e(e.onBeforeResponse)};return Object.assign(n=>Ke(n,e.handler,t),{__is_handler__:!0})}function $e(e){return e?Array.isArray(e)?e:[e]:void 0}async function Ke(e,t,r){if(r.onRequest){for(const d of r.onRequest)if(await d(e),e.handled)return}const i={body:await t(e)};if(r.onBeforeResponse)for(const d of r.onBeforeResponse)await d(e,i);return i.body}const Qe=Ze;function et(e){return me(e,"__is_handler__")}function tt(e){if(et(e))return e;if(typeof e!="function")throw new TypeError("Invalid handler. It should be a function:",e);return Qe(t=>rt(e,t.node.req,t.node.res))}function rt(e,t,r){const n=e.length>2;return new Promise((i,d)=>{const g=h=>(n&&(r.off("close",g),r.off("error",g)),h?d(Je(h)):i(void 0));try{const h=e(t,r,g);n&&h===void 0?(r.once("close",g),r.once("error",g)):i(h)}catch(h){g(h)}})}const nt=e=>{const t=n=>(i,d)=>e.router[n](i,tt((g,h)=>(h.setHeader("x-powered-by","ScaleX"),d({req:g,res:h,setStatusCode:D=>h.statusCode=D}))));return{methods:{get:t("get"),post:t("post"),patch:t("patch"),put:t("put"),delete:t("delete")},server:e}},st=e=>{const t=n=>(i,d)=>e[n](i,async(g,h)=>{h.setHeader("x-powered-by","ScaleX"),h.send(await d({req:g,res:h,setStatusCode:h.status}))});return{methods:{get:t("get"),post:t("post"),patch:t("patch"),put:t("put"),delete:t("delete")},server:e}},ot=e=>{const t=n=>(i,d)=>e[n](i,async(g,h)=>{h.header("x-powered-by","ScaleX"),h.send(await d({req:g,res:h,setStatusCode:h.status}))});return{methods:{get:t("get"),post:t("post"),patch:t("patch"),put:t("put"),delete:t("delete")},server:e}},at=e=>{const t=n=>(i,d)=>e[n](i,({request:g,set:h})=>(h.headers["x-powered-by"]="ScaleX",d({req:g,res:null,setStatusCode:D=>h.status=D})));return{methods:{get:t("get"),post:t("post"),patch:t("patch"),put:t("put"),delete:t("delete")},server:e}};w.createApp=ze,w.createModule=Fe,w.createRouter=Ne,w.createService=Le,w.elysiaProvider=at,w.expressProvider=st,w.fastifyProvider=ot,w.nitroProvider=nt,Object.defineProperty(w,Symbol.toStringTag,{value:"Module"})});
