"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const m=require("nixle");function w(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function S(e){if(e.__esModule)return e;var n=e.default;if(typeof n=="function"){var o=function r(){return this instanceof r?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};o.prototype=n.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var t=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(o,r,t.get?t:{enumerable:!0,get:function(){return e[r]}})}),o}var c={exports:{}},l={};/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */l.parse=E;l.serialize=x;var b=decodeURIComponent,O=encodeURIComponent,C=/; */,d=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function E(e,n){if(typeof e!="string")throw new TypeError("argument str must be a string");for(var o={},r=n||{},t=e.split(C),a=r.decode||b,i=0;i<t.length;i++){var s=t[i],u=s.indexOf("=");if(!(u<0)){var v=s.substr(0,u).trim(),f=s.substr(++u,s.length).trim();f[0]=='"'&&(f=f.slice(1,-1)),o[v]==null&&(o[v]=T(f,a))}}return o}function x(e,n,o){var r=o||{},t=r.encode||O;if(typeof t!="function")throw new TypeError("option encode is invalid");if(!d.test(e))throw new TypeError("argument name is invalid");var a=t(n);if(a&&!d.test(a))throw new TypeError("argument val is invalid");var i=e+"="+a;if(r.maxAge!=null){var s=r.maxAge-0;if(isNaN(s)||!isFinite(s))throw new TypeError("option maxAge is invalid");i+="; Max-Age="+Math.floor(s)}if(r.domain){if(!d.test(r.domain))throw new TypeError("option domain is invalid");i+="; Domain="+r.domain}if(r.path){if(!d.test(r.path))throw new TypeError("option path is invalid");i+="; Path="+r.path}if(r.expires){if(typeof r.expires.toUTCString!="function")throw new TypeError("option expires is invalid");i+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(i+="; HttpOnly"),r.secure&&(i+="; Secure"),r.sameSite){var u=typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite;switch(u){case!0:i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"strict":i+="; SameSite=Strict";break;case"none":i+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return i}function T(e,n){try{return n(e)}catch{return e}}var g={};const P={},_=Object.freeze(Object.defineProperty({__proto__:null,default:P},Symbol.toStringTag,{value:"Module"})),j=S(_);(function(e){var n=j;e.sign=function(r,t){if(typeof r!="string")throw new TypeError("Cookie value must be provided as a string.");if(typeof t!="string")throw new TypeError("Secret string must be provided.");return r+"."+n.createHmac("sha256",t).update(r).digest("base64").replace(/\=+$/,"")},e.unsign=function(r,t){if(typeof r!="string")throw new TypeError("Signed cookie string must be provided.");if(typeof t!="string")throw new TypeError("Secret string must be provided.");var a=r.slice(0,r.lastIndexOf(".")),i=e.sign(a,t);return o(i)==o(r)?a:!1};function o(r){return n.createHash("sha1").update(r).digest("hex")}})(g);/*!
 * cookie-parser
 * Copyright(c) 2014 TJ Holowaychuk
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var N=l,$=g;c.exports=A;c.exports.JSONCookie=y;c.exports.JSONCookies=p;c.exports.signedCookie=h;c.exports.signedCookies=k;function A(e,n){var o=!e||Array.isArray(e)?e||[]:[e];return function(t,a,i){if(t.cookies)return i();var s=t.headers.cookie;if(t.secret=o[0],t.cookies=Object.create(null),t.signedCookies=Object.create(null),!s)return i();t.cookies=N.parse(s,n),o.length!==0&&(t.signedCookies=k(t.cookies,o),t.signedCookies=p(t.signedCookies)),t.cookies=p(t.cookies),i()}}function y(e){if(!(typeof e!="string"||e.substr(0,2)!=="j:"))try{return JSON.parse(e.slice(2))}catch{return}}function p(e){for(var n=Object.keys(e),o,r,t=0;t<n.length;t++)o=n[t],r=y(e[o]),r&&(e[o]=r);return e}function h(e,n){if(typeof e=="string"){if(e.substr(0,2)!=="s:")return e;for(var o=!n||Array.isArray(n)?n||[]:[n],r=0;r<o.length;r++){var t=$.unsign(e.slice(2),o[r]);if(t!==!1)return t}return!1}}function k(e,n){for(var o=Object.keys(e),r,t,a=Object.create(null),i,s=0;s<o.length;s++)t=o[s],i=e[t],r=h(i,n),i!==r&&(a[t]=r,delete e[t]);return a}var M=c.exports;const H=w(M),J=m.createProvider(e=>(e.use(H()),{server:e,request:(n,o,r)=>e[n](o,async(t,a)=>{a.send(await r({request:t,response:a,params:t.params||{},query:t.query||{},setStatusCode:i=>a.status(i),setHeader:(i,s)=>a.setHeader(i,s),setCookie:(i,s,u={})=>a.cookie(i,s,u)}))})}));exports.expressProvider=J;
