(function(u,d){typeof exports=="object"&&typeof module<"u"?d(exports,require("nixle")):typeof define=="function"&&define.amd?define(["exports","nixle"],d):(u=typeof globalThis<"u"?globalThis:u||self,d(u.express={},u.nixle))})(this,function(u,d){"use strict";function S(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function b(e){if(e.__esModule)return e;var n=e.default;if(typeof n=="function"){var i=function r(){return this instanceof r?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};i.prototype=n.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var t=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(i,r,t.get?t:{enumerable:!0,get:function(){return e[r]}})}),i}var f={exports:{}},v={};/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */v.parse=C,v.serialize=T;var x=decodeURIComponent,O=encodeURIComponent,E=/; */,p=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function C(e,n){if(typeof e!="string")throw new TypeError("argument str must be a string");for(var i={},r=n||{},t=e.split(E),a=r.decode||x,o=0;o<t.length;o++){var s=t[o],c=s.indexOf("=");if(!(c<0)){var w=s.substr(0,c).trim(),l=s.substr(++c,s.length).trim();l[0]=='"'&&(l=l.slice(1,-1)),i[w]==null&&(i[w]=_(l,a))}}return i}function T(e,n,i){var r=i||{},t=r.encode||O;if(typeof t!="function")throw new TypeError("option encode is invalid");if(!p.test(e))throw new TypeError("argument name is invalid");var a=t(n);if(a&&!p.test(a))throw new TypeError("argument val is invalid");var o=e+"="+a;if(r.maxAge!=null){var s=r.maxAge-0;if(isNaN(s)||!isFinite(s))throw new TypeError("option maxAge is invalid");o+="; Max-Age="+Math.floor(s)}if(r.domain){if(!p.test(r.domain))throw new TypeError("option domain is invalid");o+="; Domain="+r.domain}if(r.path){if(!p.test(r.path))throw new TypeError("option path is invalid");o+="; Path="+r.path}if(r.expires){if(typeof r.expires.toUTCString!="function")throw new TypeError("option expires is invalid");o+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(o+="; HttpOnly"),r.secure&&(o+="; Secure"),r.sameSite){var c=typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite;switch(c){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return o}function _(e,n){try{return n(e)}catch{return e}}var y={};const P=b(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));(function(e){var n=P;e.sign=function(r,t){if(typeof r!="string")throw new TypeError("Cookie value must be provided as a string.");if(typeof t!="string")throw new TypeError("Secret string must be provided.");return r+"."+n.createHmac("sha256",t).update(r).digest("base64").replace(/\=+$/,"")},e.unsign=function(r,t){if(typeof r!="string")throw new TypeError("Signed cookie string must be provided.");if(typeof t!="string")throw new TypeError("Secret string must be provided.");var a=r.slice(0,r.lastIndexOf(".")),o=e.sign(a,t);return i(o)==i(r)?a:!1};function i(r){return n.createHash("sha1").update(r).digest("hex")}})(y);/*!
 * cookie-parser
 * Copyright(c) 2014 TJ Holowaychuk
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var j=v,N=y;f.exports=$,f.exports.JSONCookie=h,f.exports.JSONCookies=g,f.exports.signedCookie=m,f.exports.signedCookies=k;function $(e,n){var i=!e||Array.isArray(e)?e||[]:[e];return function(t,a,o){if(t.cookies)return o();var s=t.headers.cookie;if(t.secret=i[0],t.cookies=Object.create(null),t.signedCookies=Object.create(null),!s)return o();t.cookies=j.parse(s,n),i.length!==0&&(t.signedCookies=k(t.cookies,i),t.signedCookies=g(t.signedCookies)),t.cookies=g(t.cookies),o()}}function h(e){if(!(typeof e!="string"||e.substr(0,2)!=="j:"))try{return JSON.parse(e.slice(2))}catch{return}}function g(e){for(var n=Object.keys(e),i,r,t=0;t<n.length;t++)i=n[t],r=h(e[i]),r&&(e[i]=r);return e}function m(e,n){if(typeof e=="string"){if(e.substr(0,2)!=="s:")return e;for(var i=!n||Array.isArray(n)?n||[]:[n],r=0;r<i.length;r++){var t=N.unsign(e.slice(2),i[r]);if(t!==!1)return t}return!1}}function k(e,n){for(var i=Object.keys(e),r,t,a=Object.create(null),o,s=0;s<i.length;s++)t=i[s],o=e[t],r=m(o,n),o!==r&&(a[t]=r,delete e[t]);return a}var A=f.exports;const M=S(A),H=d.createProvider(e=>(e.use(M()),{server:e,request:(n,i,r)=>e[n](i,async(t,a)=>{a.send(await r({request:t,response:a,params:t.params||{},query:t.query||{},setStatusCode:o=>a.status(o),setHeader:(o,s)=>a.setHeader(o,s),setCookie:(o,s,c={})=>a.cookie(o,s,c)}))})}));u.expressProvider=H,Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})});
