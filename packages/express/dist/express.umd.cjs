(function(u,f){typeof exports=="object"&&typeof module<"u"?f(exports,require("nixle")):typeof define=="function"&&define.amd?define(["exports","nixle"],f):(u=typeof globalThis<"u"?globalThis:u||self,f(u.express={},u.nixle))})(this,function(u,f){"use strict";function S(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function b(e){if(e.__esModule)return e;var o=e.default;if(typeof o=="function"){var i=function r(){return this instanceof r?Reflect.construct(o,arguments,this.constructor):o.apply(this,arguments)};i.prototype=o.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var t=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(i,r,t.get?t:{enumerable:!0,get:function(){return e[r]}})}),i}var c={exports:{}},v={};/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */v.parse=C,v.serialize=T;var x=decodeURIComponent,O=encodeURIComponent,E=/; */,p=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function C(e,o){if(typeof e!="string")throw new TypeError("argument str must be a string");for(var i={},r=o||{},t=e.split(E),s=r.decode||x,n=0;n<t.length;n++){var a=t[n],d=a.indexOf("=");if(!(d<0)){var w=a.substr(0,d).trim(),l=a.substr(++d,a.length).trim();l[0]=='"'&&(l=l.slice(1,-1)),i[w]==null&&(i[w]=_(l,s))}}return i}function T(e,o,i){var r=i||{},t=r.encode||O;if(typeof t!="function")throw new TypeError("option encode is invalid");if(!p.test(e))throw new TypeError("argument name is invalid");var s=t(o);if(s&&!p.test(s))throw new TypeError("argument val is invalid");var n=e+"="+s;if(r.maxAge!=null){var a=r.maxAge-0;if(isNaN(a)||!isFinite(a))throw new TypeError("option maxAge is invalid");n+="; Max-Age="+Math.floor(a)}if(r.domain){if(!p.test(r.domain))throw new TypeError("option domain is invalid");n+="; Domain="+r.domain}if(r.path){if(!p.test(r.path))throw new TypeError("option path is invalid");n+="; Path="+r.path}if(r.expires){if(typeof r.expires.toUTCString!="function")throw new TypeError("option expires is invalid");n+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(n+="; HttpOnly"),r.secure&&(n+="; Secure"),r.sameSite){var d=typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite;switch(d){case!0:n+="; SameSite=Strict";break;case"lax":n+="; SameSite=Lax";break;case"strict":n+="; SameSite=Strict";break;case"none":n+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return n}function _(e,o){try{return o(e)}catch{return e}}var y={};const P=b(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));(function(e){var o=P;e.sign=function(r,t){if(typeof r!="string")throw new TypeError("Cookie value must be provided as a string.");if(typeof t!="string")throw new TypeError("Secret string must be provided.");return r+"."+o.createHmac("sha256",t).update(r).digest("base64").replace(/\=+$/,"")},e.unsign=function(r,t){if(typeof r!="string")throw new TypeError("Signed cookie string must be provided.");if(typeof t!="string")throw new TypeError("Secret string must be provided.");var s=r.slice(0,r.lastIndexOf(".")),n=e.sign(s,t);return i(n)==i(r)?s:!1};function i(r){return o.createHash("sha1").update(r).digest("hex")}})(y);/*!
 * cookie-parser
 * Copyright(c) 2014 TJ Holowaychuk
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var j=v,N=y;c.exports=$,c.exports.JSONCookie=h,c.exports.JSONCookies=g,c.exports.signedCookie=k,c.exports.signedCookies=m;function $(e,o){var i=!e||Array.isArray(e)?e||[]:[e];return function(t,s,n){if(t.cookies)return n();var a=t.headers.cookie;if(t.secret=i[0],t.cookies=Object.create(null),t.signedCookies=Object.create(null),!a)return n();t.cookies=j.parse(a,o),i.length!==0&&(t.signedCookies=m(t.cookies,i),t.signedCookies=g(t.signedCookies)),t.cookies=g(t.cookies),n()}}function h(e){if(!(typeof e!="string"||e.substr(0,2)!=="j:"))try{return JSON.parse(e.slice(2))}catch{return}}function g(e){for(var o=Object.keys(e),i,r,t=0;t<o.length;t++)i=o[t],r=h(e[i]),r&&(e[i]=r);return e}function k(e,o){if(typeof e=="string"){if(e.substr(0,2)!=="s:")return e;for(var i=!o||Array.isArray(o)?o||[]:[o],r=0;r<i.length;r++){var t=N.unsign(e.slice(2),i[r]);if(t!==!1)return t}return!1}}function m(e,o){for(var i=Object.keys(e),r,t,s=Object.create(null),n,a=0;a<i.length;a++)t=i[a],n=e[t],r=k(n,o),n!==r&&(s[t]=r,delete e[t]);return s}var A=c.exports;const M=S(A),H=f.createProvider(e=>(e.use(M()),{server:e,request:(o,i,r)=>e[o](i,async(t,s)=>{s.send(await r({request:t,response:s,setStatusCode:s.status,setHeader:s.setHeader,setCookie:s.cookie}))})}));u.expressProvider=H,Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})});
